# UniversalFirmware

通用测试固件，集成各种嵌入式模块。

对各种库的裁剪，使他们变得更趁手。

尽量减少各种头文件依赖，具有独立性，就像标准 C 库头文件。\

尽量减少文件夹分层，这会让事情变得复杂起来。

## Include

这个文件夹值得被好好设计，就像 C99，POSIX 等接口广为人知，但是具体实现却并不关注。

我有一个 ZSTACK ，里面也有一些，到时候看看能不能合并。

并不是所有头文件都在这里，这里是“标准化的”头文件，如果对厂商驱动做简单封装，这些依赖的头文件需要放在 driver 中。

### DeviceTree

之前 Linus 因为驱动的问题发火，我觉得驱动就是驱动，IRQ 这些配置信息，不应该在驱动里面，所以我要单独弄个目录存放。

包含各个 IP 的基地址，和中断向量值等静态信息。
其实写成 DTS 格式，最后还是转成头文件格式，不如直接写。
我希望动态配置引脚功能，怎么做？

## Project

Project 目录包含 Project 本身，开发板名字，SoC名字等等。如果是 SoC 那么内容仅限 SoC，如果是 ProjectName 还会包含业务相关的代码。

## Entry

顾名思义，就是入口，main 也是在 Reset ISR 中执行的。system 在 main() 之前做了一些工作，因为之前的 clib 初始化需要用到 FPU，所以必须在 systeminit 中将 FPU 使能。

## IP

关注寄存器细节，本质上是 IP 的 C 语言封装，也可以是 CMSIS 或者厂商提供的驱动的封装。但是对外的接口（头文件）规范保持一致。

内部按照厂商区分，因为做 IP 的就那么几个。

## HAL

不关注寄存器细节，在乎功能，而且是联合多个 IP ，如 DMA，引脚配置等

在多个 IP 的基础上，开发一个功能，比如 DMA 搬运 SPI 数据的驱动：spi_dma_transfer
